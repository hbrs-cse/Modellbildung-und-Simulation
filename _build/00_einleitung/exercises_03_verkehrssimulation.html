---
redirect_from:
  - "/00-einleitung/exercises-03-verkehrssimulation"
interact_link: content/00_einleitung/exercises_03_verkehrssimulation.ipynb
kernel_name: octave
has_widgets: false
title: |-
  Verkehrssimulation
prev_page:
  url: /00_einleitung/exercises_02_fluessigkeit.html
  title: |-
    Flüssigkeit im Boden
next_page:
  url: /emptypage.html
  title: |-
    Conway's Game of Life
comment: "***PROGRAMMATICALLY GENERATED, DO NOT EDIT. SEE ORIGINAL FILES IN /content***"
---

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Verkehrssimulation">Verkehrssimulation<a class="anchor-link" href="#Verkehrssimulation"> </a></h1><p>In dieser Übungsaufgabe soll das Fahrverhalten von Autofahrern und die damit einhergehende Stauentwicklung modelliert werden. In einem 7,5 km langen einspurigen Tunnel bilden sich zu Hauptverkehrszeiten immer wieder Staus, ohne dass ein Unfall oder eine Baustelle als Ursache ausgemacht werden kann. Ampeln gibt es auf der gesamten Strecke nicht. Ihre Aufgabe ist ein simples Computermodell zu erstellen, das in der Lage ist dieses Phänomen zu reproduzieren. Welche Durchschnittsgeschwindigkeit kann man bei einer gegebenen Verkehrsdichte erwarten? Wie hängt der Verkehrsfluss von der Verkehrsdichte ab?
<img src="../images/tunnel.jpg" alt=""></p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Modellbeschreibung">Modellbeschreibung<a class="anchor-link" href="#Modellbeschreibung"> </a></h2><p>Im Durchschnitt belegt ein Fahrzeug ca. 7,5 m der Strecke in einem Stau. Diese Länge beinhaltet bereits den Abstand zum Auto davor. Die 7,5 km lange Strecke lässt sich demnach in 1000 Zellen zerlegen. Zu jedem Zeitpunkt ist eine Zelle entweder frei oder von einem Auto belegt. In den Tunnel passen maximal 1000 Fahrzeuge. Abbildung 1 zeigt beispielhaft einen Streckenabschnitt aus 10 Zellen mit 5 Fahrzeugen A, B, C, D und E. In Abbildung 1(a) ist der Streckenabschnitt dargestellt. Die Zellen 2, 3, 5, 8 und 10 sind jeweils mit einem Auto belegt. Abbildung 1(b) zeigt eine komprimierte Darstellung. In einem Positionsvektor werden die Zellennummern der 5 Fahrzeuge gespeichert.</p>
<figure>
  <img src="../images/zellnummern.PNG" alt="my alt text"/>
  <figcaption>Abbildung 1: Zwei Darstellungen für einen 75 m langen Streckenabschnitt mit 5 Fahrzeugen A, B, C, D und E</figcaption>
</figure>
Ein Fahrzeug mit einer Geschwindigkeit von 27 km/h = 7, 5 m/s rückt innerhalb einer Sekunde genau eine Zelle vor. Die Maximalgeschwindigkeit im Tunnel beträgt 135 km/h, bzw. 5 Zellen pro Sekunde. Simulieren Sie den Verkehrsfluss sekundenweise. Dies entspricht in etwa der Reaktionszeit eines Autofahrers. In jedem Zeitschritt von einer Sekunde ergibt sich die Position und Geschwindigkeit eines Fahrzeuges nach folgenden einfachen Regeln, die in der angegebenen Reihenfolge umgesetzt werden:

1. Jedes Auto, das noch nicht die Maximalgeschwindigkeit erreicht hat, erhöht seine Geschwindigkeit um eine Zelle pro Sekunde.
<figure>
  <img src="../images/bild1_stau.png" alt="my alt text"/>
  <figcaption>Abbildung 2: Beschleunigung aller Fahrzeuge um 1</figcaption>
</figure>
2. Falls die Geschwindigkeit eines Fahrzeuges zu einer Kollision mit dem Fahrzeug davor führen würde, reduziert sich die Geschwindigkeit entsprechend. Beispiel: Fahrzeug A befindet sich in Zelle 496 und hat eine Geschwindigkeit von 4 Zellen pro Sekunde. Zelle 499 ist aber von Fahrzeug B belegt. Demnach reduziert sich die Geschwindigkeit von Fahrzeug A auf 2 Zellen pro Sekunde.
<figure>
  <img src="../images/bild2_stau.png" alt="my alt text"/>
  <figcaption>Abbildung 3: Abbremsen der unfallgefährdeten Fahrzeuge</figcaption>
</figure>
3. Ein Anteil $p_{\text{SF}}$ der Fahrer auf dem Streckenabschnitt sind Sonntagsfahrer. Deren Geschwindigkeit $v$ reduziert sich um eine Zelle pro Sekunde, sofern sie nicht schon stehen.
<figure>
  <img src="../images/bild3_stau.png" alt="my alt text"/>
  <figcaption>Abbildung 4: Abbremsen der zufällig gewählten Sonntagsfahrer</figcaption>
</figure>
4. Alle Fahrzeuge rücken entsprechend ihrer Geschwindigkeit vor.
Die Verkehrsdichte $\rho$ im betrachteten Zeitraum bleibe annähernd konstant. Zu jeder Zeit verlassen also so viele Autos den Steckenabschnitt wie neue hinzu kommen. Um diesen Effekt zu berücksichtigen, bedienen sie sich eines Tricks: Gehen Sie von periodischen Randbedingungen aus. Sobald ein Auto die 7,5 km lange Strecke verlässt, taucht es am Anfang wieder auf (In anderen Worten: Die Zellen mit den Nummern i und 1000+i sind identisch). Eine Anschauung des Tricks ist es, sich den Tunnel als Ringstraße mit einem Umfang von 7, 5 km vorzustellen.
<figure>
  <img src="../images/ringstrasse.gif" alt="my alt text"/>
  <figcaption>Abbildung 5: Darstellung der periodischen Randbedingungen als Ringstraße</figcaption>
</figure>
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Aufgabe-1">Aufgabe 1<a class="anchor-link" href="#Aufgabe-1"> </a></h2><ol>
<li><p>Erstellen Sie ein Matlab–Skript, das zunächst die folgenden Parameter festlegt:</p>
<ul>
<li>normalisierte Verkehrsdichte $\rho$</li>
<li>Maximalgeschwindigkeit $v_{\text{max}}$ (Zellen/Sekunde) </li>
<li>Anteil Sonntagsfahrer $p_{\text{SF}}$ </li>
<li>Streckenlänge $L$ (Anzahl von Zellen) </li>
<li>Simulationszeitraum $T$ (Sekunden)</li>
</ul>
</li>
<li><p>Die normalisierte Verkehrsdichte $\rho$ ist der Anteil der belegten Zellen, also eine einheitslose Zahl zwischen 0 und 1.</p>
<p>Berechnen Sie die Anzahl der Fahrzeuge <code>n</code> aus der Streckenlänge <code>len</code> und der normalisierten Verkehrsdichte $\rho$ und erzeugen Sie zwei Vektoren <code>pos</code> und <code>vel</code> der Länge <code>n</code> für die Positionen (Zellennummer) und Geschwindigkeiten (Zellen/Sekunde) der Fahrzeuge. Zu Beginn der Simulation sind die Autos beliebig auf der Strecke verteilt. Die Anfangsgeschwindigkeit aller Fahrzeuge beträgt 0 Zellen/Sekunde. <strong>Tipp</strong>: Schauen Sie sich die Matlab–Funktion <code>randperm(m,n)</code> an. Sortieren sie den Vektor <code>pos</code> zu Beginn der Simulation aufsteigend.</p>
<p>Berechnen sie die Positionen <code>pos</code> und Geschwindigkeiten <code>vel</code> aller Fahrzeuge nach den vier oben genannten Regeln für jede Sekunde innerhalb einer Stunde. Tipp: Für die Umsetzung der periodischen Randbedingungen könnte die Funktion <code>mod(k, n)</code> hilfreich sein. Für die Umsetzung von Regel 3 bietet sich wieder <code>randperm(n, k)</code> an.</p>
<p>Animieren Sie den Verkehrsfluss um zu überprüfen, ob ihr Modell funktioniert. Gehen Sie dabei von einer Maximalgeschwindigkeit von 5 Zellen/Sekunde, $p_{\text{SF}}$ = 0.2 sowie einer normalisierten Verkehrsdichte von $\rho$ = 0.4 aus. <strong>Tipp</strong>: Eine Animation kann zum Beispiel mit den Matlab–Funktionen <code>scatter</code> und <code>pause(t)</code> in der Hauptschleife ihres Programmes erzeugt werden.</p>
</li>
</ol>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-octave"><pre><span></span><span class="c">%% input parameters</span>
<span class="n">density</span>     <span class="p">=</span> <span class="mf">0.4</span><span class="p">;</span>    <span class="c">% the ratio of road cells occupied by a car</span>
<span class="n">max_speed</span>   <span class="p">=</span> <span class="mi">5</span><span class="p">;</span>      <span class="c">% the maximally posible speed [cells/second]</span>
<span class="n">p_SF</span>        <span class="p">=</span> <span class="mf">0.20</span><span class="p">;</span>   <span class="c">% the ratio of &#39;sunday drivers&#39;</span>
<span class="n">len</span>         <span class="p">=</span> <span class="mi">1000</span><span class="p">;</span>   <span class="c">% the length of the road [cells]</span>
<span class="n">T</span>           <span class="p">=</span> <span class="mi">3600</span><span class="p">;</span>   <span class="c">% the simulation time [seconds]</span>

    <span class="c">%&lt;&lt;&lt;&lt;&lt;&lt; ADD YOUR CODE HERE &gt;&gt;&gt;&gt;&gt;&gt;%</span>

<span class="c">%% initial configuration</span>

    <span class="c">%&lt;&lt;&lt;&lt;&lt;&lt; ADD YOUR CODE HERE &gt;&gt;&gt;&gt;&gt;&gt;%</span>

<span class="c">%% main time loop</span>
<span class="k">for</span> <span class="n">t</span><span class="p">=</span><span class="mi">1</span><span class="p">:</span><span class="n">T</span>
    <span class="c">%1.) increase speed of all cars by one</span>

        <span class="c">%&lt;&lt;&lt;&lt;&lt;&lt; ADD YOUR CODE HERE &gt;&gt;&gt;&gt;&gt;&gt;%</span>
    
    <span class="c">%2.) decrease speed if it would cause a collision otherwise</span>

        <span class="c">%&lt;&lt;&lt;&lt;&lt;&lt; ADD YOUR CODE HERE &gt;&gt;&gt;&gt;&gt;&gt;%</span>
    
    <span class="c">%3.) decrease velocity of a random selection </span>
    <span class="c">%    of p_SF*num_cars by 1</span>
    
        <span class="c">%&lt;&lt;&lt;&lt;&lt;&lt; ADD YOUR CODE HERE &gt;&gt;&gt;&gt;&gt;&gt;%</span>
    
    <span class="c">%4.) move cars according to their speed</span>

        <span class="c">%&lt;&lt;&lt;&lt;&lt;&lt; ADD YOUR CODE HERE &gt;&gt;&gt;&gt;&gt;&gt;%</span>
    
    <span class="c">%5.) animate</span>
    
        <span class="c">%&lt;&lt;&lt;&lt;&lt;&lt; ADD YOUR CODE HERE &gt;&gt;&gt;&gt;&gt;&gt;%</span>
<span class="k">end</span><span class="p">;</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Aufgabe-2">Aufgabe 2<a class="anchor-link" href="#Aufgabe-2"> </a></h2><p>Wandeln Sie ihr Skript in eine Matlab–Funktion um, die beim Aufruf eine Simulation ausführt. 
Die Funktion erhält als Eingabe</p>
<ul>
<li>normalisierte Verkehrsdichte $\rho$ </li>
<li>Maximalgeschwindigkeit $v_{\text{max}}$ </li>
<li>Anteil der Sonntagsfahrer $p_{\text{SF}}$ </li>
</ul>
<p>und gibt</p>
<ul>
<li>die durchschnittliche Geschwindigkeit $v_{\text{mean}}$ </li>
<li>den durchschnittlichen Verkehrsfluss $Q$</li>
</ul>
<p>als Ausgabe aus. Legen Sie <code>T = 3600</code> Sekunden und <code>len = 1000</code> Zellen fest. Der Verkehrsfluss $Q$ entspricht der Anzahl an Autos, die pro Zeiteinheit einen Zähler passieren, z.B. zwischen Zelle 1000 und 1.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-octave"><pre><span></span><span class="c">%%file trafficflow.m</span>
<span class="k">function</span><span class="w"> </span>[v_ave,q_ave] <span class="p">=</span><span class="w"> </span><span class="nf">trafficflow</span><span class="p">(</span>density,max_speed,p_SF<span class="p">)</span><span class="w"></span>

<span class="n">len</span>         <span class="p">=</span> <span class="mi">1000</span><span class="p">;</span>   <span class="c">% the length of the road [cells]</span>
<span class="n">T</span>           <span class="p">=</span> <span class="mi">3600</span><span class="p">;</span>   <span class="c">% the simulation time [seconds]</span>

    <span class="c">%&lt;&lt;&lt;&lt;&lt;&lt; ADD YOUR CODE HERE &gt;&gt;&gt;&gt;&gt;&gt;%</span>

<span class="c">%% initial configuration</span>

    <span class="c">%&lt;&lt;&lt;&lt;&lt;&lt; ADD YOUR CODE HERE &gt;&gt;&gt;&gt;&gt;&gt;%</span>

<span class="c">%% main time loop</span>
<span class="k">for</span> <span class="n">i</span><span class="p">=</span><span class="mi">1</span><span class="p">:</span><span class="n">T</span>
    <span class="c">%1.) increase speed of all cars by one if speed is not max yet</span>
    
        <span class="c">%&lt;&lt;&lt;&lt;&lt;&lt; ADD YOUR CODE HERE &gt;&gt;&gt;&gt;&gt;&gt;%</span>
    
    <span class="c">%2.) decrease speed if it would cause a collision otherwise</span>
    
        <span class="c">%&lt;&lt;&lt;&lt;&lt;&lt; ADD YOUR CODE HERE &gt;&gt;&gt;&gt;&gt;&gt;%</span>
    
    <span class="c">%3.) decrease velocity of a random selection </span>
    <span class="c">%    of p_SF*num_cars by 1</span>
    
        <span class="c">%&lt;&lt;&lt;&lt;&lt;&lt; ADD YOUR CODE HERE &gt;&gt;&gt;&gt;&gt;&gt;%</span>
    
    <span class="c">%4.) move cars according to their speed</span>
        
        <span class="c">%&lt;&lt;&lt;&lt;&lt;&lt; ADD YOUR CODE HERE &gt;&gt;&gt;&gt;&gt;&gt;%</span>
        
    <span class="c">%5.) animate</span>
    
        <span class="c">%&lt;&lt;&lt;&lt;&lt;&lt; ADD YOUR CODE HERE &gt;&gt;&gt;&gt;&gt;&gt;%</span>


<span class="c">%calculate average velocity of all cars and time steps</span>
    
    <span class="c">%&lt;&lt;&lt;&lt;&lt;&lt; ADD YOUR CODE HERE &gt;&gt;&gt;&gt;&gt;&gt;%</span>

<span class="k">end</span><span class="p">;</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>In einem weiteren Matlab–Skript berechnen Sie für normalisierte Verkehrsdichten $\rho$ = 0.05, 0.10, 0.15, 0.20, ..., 1 den Verkehrsfluss $Q$ und die durchschnittliche Geschwindigkeit $v_{\text{mean}}$ mit Hilfe dieser Matlab Funktion <code>trafficflow</code>. Gehen Sie von $p_{\text{SF}}$ = 0.2 und $v_{\text{max}}$ = 5 Zellen/Sekunde aus.
Erstellen Sie mit ihrem Skript sowohl ein $\rho~–~v_{\text{mean}}~–~$Diagramm als auch ein $\rho~–~Q~–~$Diagramm um die Abhängigkeiten des Verkehrsflusses bzw. der Durchschnittsgeschwindigkeit von der Verkehrsdichte darzustellen.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-octave"><pre><span></span><span class="c">%% input parameters</span>
<span class="n">max_speed</span>   <span class="p">=</span> <span class="mi">5</span><span class="p">;</span>      <span class="c">% the maximally posible speed [cells/second]</span>
<span class="n">p_SF</span>        <span class="p">=</span> <span class="mf">0.20</span><span class="p">;</span>   <span class="c">% the ratio of &#39;sunday drivers&#39;</span>

    <span class="c">%&lt;&lt;&lt;&lt;&lt;&lt; ADD YOUR CODE HERE &gt;&gt;&gt;&gt;&gt;&gt;%</span>
    
<span class="c">%% main loop</span>
<span class="c">%1.) iterate through normalized densities</span>

<span class="c">%for    </span>
        <span class="c">%&lt;&lt;&lt;&lt;&lt;&lt; ADD YOUR CODE HERE &gt;&gt;&gt;&gt;&gt;&gt;%</span>

    <span class="c">%2.) call function &quot;trafficflow&quot; and store outputs</span>
        
        <span class="c">%&lt;&lt;&lt;&lt;&lt;&lt; ADD YOUR CODE HERE &gt;&gt;&gt;&gt;&gt;&gt;%</span>
<span class="c">%end</span>

<span class="nb">figure</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="nb">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span>

<span class="c">%3.) plot density vs. maximal velocity</span>

    <span class="c">%&lt;&lt;&lt;&lt;&lt;&lt; ADD YOUR CODE HERE &gt;&gt;&gt;&gt;&gt;&gt;%</span>
    
<span class="nb">title</span><span class="p">(</span><span class="s">&#39;density vs. average velocity&#39;</span><span class="p">);</span>
<span class="nb">xlabel</span><span class="p">(</span><span class="s">&#39;normalized density&#39;</span><span class="p">)</span>
<span class="nb">ylabel</span><span class="p">(</span><span class="s">&#39;average velocity [km/h]&#39;</span><span class="p">)</span>

<span class="nb">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">);</span> 

<span class="c">%4.) plot density vs. traffic flow</span>
    
    <span class="c">%&lt;&lt;&lt;&lt;&lt;&lt; ADD YOUR CODE HERE &gt;&gt;&gt;&gt;&gt;&gt;%</span>
    
<span class="nb">title</span><span class="p">(</span><span class="s">&#39;density vs. traffic flow&#39;</span><span class="p">);</span>
<span class="nb">xlabel</span><span class="p">(</span><span class="s">&#39;normalized density&#39;</span><span class="p">)</span>
<span class="nb">ylabel</span><span class="p">(</span><span class="s">&#39;traffic flow [cars/second]&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<figure>
  <img src="../images/diagramm_stau.PNG" alt="my alt text"/>
    <figcaption>Abbildung 6: $\rho~–~v_{\text{mean}}~–~$Diagramm und $\rho~–~Q~–~$Diagramm zum Vergleich mit der eigenen Lösung</figcaption>
</figure>
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Aufgabe-3">Aufgabe 3<a class="anchor-link" href="#Aufgabe-3"> </a></h2><p>Experimentieren Sie mit den Parametern $v_{\text{max}}$ und $p_{\text{SF}}$. Wie lässt sich der Einfluss beider Parameter auf die Durchschnittsgeschwindigkeit und den Verkehrsfluss qualitativ beschreiben? Nennen sie eine Möglichkeit den Realismus des Modells zu steigen.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-octave"><pre><span></span><span class="c">%% Qualitative Beschreibung des Einflusses von v_max auf v_mean und Q:</span>

<span class="c">%% Qualitative Beschreibung des Einflusses von p_SF auf v_mean und Q:</span>

<span class="c">%% Steigerung des Realismus durch:</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Literatur">Literatur<a class="anchor-link" href="#Literatur"> </a></h2><ul>
<li>Nagel, K., &amp; Schreckenberg, M. (1992). <a href="https://pdfs.semanticscholar.org/17a6/135c5b7af91238989514f4c709c8146031d5.pdf">A cellular automaton model for freeway traffic</a>; <em>Journal de Physique I, EDP Sciences, 2(12), 2221-2229.</em></li>
</ul>

</div>
</div>
</div>
</div>

 

