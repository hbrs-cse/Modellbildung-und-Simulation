
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Verkehrssimulation mit finiten Volumen &#8212; Modellbildung und Simulation</title>
    
  <link href="../_static/css/theme.css" rel="stylesheet">
  <link href="../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script kind="utterances">

    var commentsRunWhenDOMLoaded = cb => {
    if (document.readyState != 'loading') {
        cb()
    } else if (document.addEventListener) {
        document.addEventListener('DOMContentLoaded', cb)
    } else {
        document.attachEvent('onreadystatechange', function() {
        if (document.readyState == 'complete') cb()
        })
    }
}

var addUtterances = () => {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src = "https://utteranc.es/client.js";
    script.async = "async";

    script.setAttribute("repo", "hbrs-cse/Modellbildung-und-Simulation");
    script.setAttribute("issue-term", "pathname");
    script.setAttribute("theme", "github-light");
    script.setAttribute("label", "ðŸ’¬ comment");
    script.setAttribute("crossorigin", "anonymous");

    sections = document.querySelectorAll("div.section");
    if (sections !== null) {
        section = sections[sections.length-1];
        section.appendChild(script);
    }
}
commentsRunWhenDOMLoaded(addUtterances);
</script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.d59cb220de22ca1c485ebbdc042f0030.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <script async="async" src="https://unpkg.com/thebe@0.5.1/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe,.cell"
        const thebe_selector_input = "pre,.cell_input div.highlight"
        const thebe_selector_output = ".output,.cell_output"
    </script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Matlab EinfÃ¼hrung" href="../12_matlab/00_MATLAB_introduction.html" />
    <link rel="prev" title="Konvektion und Diffusion" href="02_konvektion_und_diffusion.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
<script async="" src="https://www.google-analytics.com/analytics.js"></script>
<script>
                        window.ga = window.ga || function () {
                            (ga.q = ga.q || []).push(arguments) };
                        ga.l = +new Date;
                        ga('create', 'UA-134708516-1', 'auto');
                        ga('set', 'anonymizeIp', true);
                        ga('send', 'pageview');
                    </script>

  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/hbrs_logo_text.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Modellbildung und Simulation</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="current nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../00_einleitung/00_einleitung.html">
   Einleitung
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../00_einleitung/01_motivation.html">
     Das Stauproblem - Motivation zur Benutzung dieses Buches
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../00_einleitung/02_verwendung_dieses_buches.html">
     Verwendung dieses Buches
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../00_einleitung/03_best_practice.html">
     Best Practices
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../01_uebungen/00_uebungsaufgaben.html">
   Einleitende Ãœbungsaufgaben
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../01_uebungen/01_fluessigkeit_im_boden.html">
     FlÃ¼ssigkeit im Boden
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../01_uebungen/02_verkehrssimulation.html">
     Verkehrssimulation mit zellulÃ¤ren Automaten
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../01_uebungen/03_der_perfekte_wurf.html">
     Der perfekte Wurf
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../01_uebungen/04_game_of_life.html">
     Game of Life
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../02_gleitkommaarithmetik/00_gleitkommaarithmetik.html">
   Gleitkommaarithmetik
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../02_gleitkommaarithmetik/01_uebungen.html">
     Ãœbungen
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../02_gleitkommaarithmetik/02_spielbeispiel_taylor.html">
     Spielbeispiel: Taylorpolynome
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../02_gleitkommaarithmetik/03_taylor.html">
     Funktionen mit Taylorpolynomen berechnen
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../03_interp_approx/00_interpolation_Und_approximation.html">
   Interpolation und Approximation
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../03_interp_approx/01_spielbeispiel_interpolation.html">
     Spielbeispiel: Interpolation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../03_interp_approx/02_lineare_interpolation.html">
     Lineare Interpolation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../03_interp_approx/03_spielbeispiel_approximation.html">
     Spielbeispiel: Approximation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../03_interp_approx/04_lineare_approximation.html">
     Lineare Approximation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../03_interp_approx/05_spline_interpolation.html">
     Spline-Interpolation
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../04_Differentiation_Integration/00_differentiation_und_integration.html">
   Differentiation und Integration
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
  <label for="toctree-checkbox-5">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../04_Differentiation_Integration/01_differentiation.html">
     Numerische Differentiation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../04_Differentiation_Integration/02_spielbeispiel_integration.html">
     Spielbeispiel: Integration
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../04_Differentiation_Integration/03_integration_and_stepcontrol.html">
     Numerische Integration (mit Schrittweitensteuerung)
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../05_lineare_gleichungen/00_lineare_gleichungssysteme.html">
   Lineare Gleichungssysteme
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
  <label for="toctree-checkbox-6">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../05_lineare_gleichungen/01_spielbeispiel_lgls.html">
     Spielbeispiel: lineare GLS
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../05_lineare_gleichungen/02_lgs_sparse.html">
     LÃ¶sung linearer Gleichungssysteme
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../05_lineare_gleichungen/03_modellierung_einer_highline.html">
     Modellierung einer Highline
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../06_nichtlineare_gleichungen/00_nichtlineare_gleichungssysteme.html">
   Nichtlineare Gleichungssysteme
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/>
  <label for="toctree-checkbox-7">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../06_nichtlineare_gleichungen/01_newton-verfahren.html">
     Newton-Verfahren
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../06_nichtlineare_gleichungen/02_bierschaumzerfall.html">
     Bierschaumzerfall
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../07_num_ode/00_numerik_gew%C3%B6hnlicher_differentialgleichungen.html">
   GewÃ¶hnliche Differentialgleichungen
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/>
  <label for="toctree-checkbox-8">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../07_num_ode/01_intro_RK/00_intro_RK.html">
     EinfÃ¼hrung in numerische Integrationsverfahren von ODEs
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/>
    <label for="toctree-checkbox-9">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../07_num_ode/01_intro_RK/01_integration_RK.html">
       Integration von ODEs mit expliziten Verfahren
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../07_num_ode/01_intro_RK/02_integration_implicit.html">
       Integration von ODEs mit impliziten Verfahren
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../07_num_ode/01_intro_RK/03_adaptive_steps.html">
       Adaptive Schrittweitensteuerung
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../07_num_ode/01_intro_RK/04_oscillation_and_vdpol.html">
       Systeme von ODEs
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../07_num_ode/01_intro_RK/05_integration_RK_evaluation.html">
       Lohnen sich Verfahren hÃ¶herer Ordnung?
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../07_num_ode/02_schwingungen/00_harmonische_schwingung.html">
     Harmonische Schwingung
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../07_num_ode/03_simulation_eines_raketenstarts/00_simulation_eines_raketenstarts.html">
     Simulation eines Raketenstarts
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../07_num_ode/04_stabilitaet_eulerverfahren/00_stabilitaet_eulerverfahren.html">
     StabilitÃ¤t des expliziten versus impliziten Eulerverfahrens
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../07_num_ode/05_modellierung_einer_highline_dynamisch/00_modellierung_einer_highline_dynamisch.html">
     Modellierung einer Highline - Zeitliche AuflÃ¶sung
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../07_num_ode/06_mass-spring-mass/00_mass-spring-mass.html">
     Rutschendes Masse-Feder-Masse System
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../08_eigenwerte/00_eigenwertprobleme.html">
   Eigenwertprobleme
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" type="checkbox"/>
  <label for="toctree-checkbox-10">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../08_eigenwerte/01_das_qr_verfahren.html">
     Das QR-Verfahren
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../08_eigenwerte/02_nullstellen_von_polynomen.html">
     Nullstellen von Polynomen
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../08_eigenwerte/03_schwingungsmoden_eines_eindimensionalen_balkens.html">
     Schwingungsmoden eines eindimensionalen Balkens
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../09_dft/00_diskrete_fouriertransformation.html">
   Diskrete Fouriertransformation
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" type="checkbox"/>
  <label for="toctree-checkbox-11">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../09_dft/01_approximation_von_periodischen_signalen.html">
     Approximation von periodischen Signalen
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../09_dft/02_filtern_verrauschter_signale.html">
     Filtern verrauschter Signale
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../09_dft/03_der_doppler_effekt.html">
     Der Doppler Effekt
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../09_dft/04_vuvuzela_filter.html">
     Vuvuzela Filter
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../10_bvp/00_randwertprobleme.html">
   Randwertprobleme
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" type="checkbox"/>
  <label for="toctree-checkbox-12">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../10_bvp/01_durchhang_eines_flexiblen_kabels.html">
     Durchhang eines flexiblen Kabels
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../10_bvp/02_temperatur_in_einem_nuklearen_brennstab.html">
     Temperatur in einem nuklearen Brennstab
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="00_partielle_differentialgleichungen.html">
   Partielle Differentialgleichungen
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" type="checkbox"/>
  <label for="toctree-checkbox-13">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="01_modellierung_einer_highline_dynamisch_pde.html">
     Modellierung einer Highline - Die LÃ¶sung als PDE
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="02_konvektion_und_diffusion.html">
     Konvektion und Diffusion
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     Verkehrssimulation mit finiten Volumen
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../12_matlab/00_MATLAB_introduction.html">
   Matlab EinfÃ¼hrung
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-14" name="toctree-checkbox-14" type="checkbox"/>
  <label for="toctree-checkbox-14">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../12_matlab/01_erste_schritte_in_matlab.html">
     Matlab einrichten
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../12_matlab/02_matlab_command_window.html">
     Matlab Command Window
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../12_matlab/03_skripte_und_funktionen.html">
     Skripte und Funktionen
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../12_matlab/04_matlab_kennenlernen.html">
     Rechnen mit Matlab
    </a>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../12_matlab/05_matlab_videos/00_matlab_videos.html">
     Grundlagenkurs und ZusatzÃ¼bungen
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-15" name="toctree-checkbox-15" type="checkbox"/>
    <label for="toctree-checkbox-15">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../12_matlab/05_matlab_videos/01_exercise1.html">
       1. Messwerte importieren, plotten und bearbeiten
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../12_matlab/05_matlab_videos/02_exercise2.html">
       2. Messwerte filtern und interpolieren
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../12_matlab/05_matlab_videos/03_exercise3.html">
       3. Polynomfitting
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../12_matlab/05_matlab_videos/04_exercise4.html">
       4. FlÃ¤chenberechnung und Newtonverfahren (1D)
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../12_matlab/05_matlab_videos/05_exercise5.html">
       5. Funktionsfitting und Newtonverfahren (nD)
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../12_matlab/05_matlab_videos/06_exercise6.html">
       6. Numerische Differentiation und Integration
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../12_matlab/05_matlab_videos/07_exercise7.html">
       7. GewÃ¶hnliche Differentialgleichungen
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../12_matlab/05_matlab_videos/08_exercise8.html">
       8. GewÃ¶hnliche Differentialgleichungen und Event-Detektion
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../12_matlab/05_matlab_videos/09_exercise9.html">
       9. Differential-Algebraische Gleichungen (1)
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../12_matlab/05_matlab_videos/10_exercise10.html">
       10. Differential-Algebraische Gleichungen (2)
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../12_matlab/05_matlab_videos/11_extra.html">
       Zusatzinfo - Mehrdimensionales Newtonverfahren
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  <div align="left"> <a href="https://github.com/hbrs-cse/Modellbildung-und-Simulation"><img src="https://github.githubassets.com/images/modules/logos_page/GitHub-Mark.png" style="width: 20px;"> Github Repository</a> <br><a href="https://creativecommons.org/licenses/by-sa/4.0/"><img src="https://upload.wikimedia.org/wikipedia/commons/e/e5/CC_BY-SA_icon.svg" alt="License: CC BY-SA 4.0"></a> <br>Powered by <a href="https://github.com/jupyter/jupyter-book">Jupyter Book</a> <br><a href="https://doi.org/10.5281/zenodo.2560551"><img src="https://zenodo.org/badge/DOI/10.5281/zenodo.2560551.svg" alt="DOI"></a> </div>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/11_pde/03_trafficPDE.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
                onclick="printPdf(this)" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        
        
        <a class="edit-button" href="https://github.com/hbrs-cse/Modellbildung-und-Simulation/edit/master/content/11_pde/03_trafficPDE.ipynb"><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Edit this page"><i class="fas fa-pencil-alt"></i>suggest edit</button></a>
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/hbrs-cse/Modellbildung-und-Simulation/master?urlpath=lab/tree/content/11_pde/03_trafficPDE.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        <button type="button" class="btn btn-secondary topbarbtn"
            onclick="initThebeSBT()" title="Launch Thebe" data-toggle="tooltip" data-placement="left"><i
                class="fas fa-play"></i><span style="margin-left: .4em;">Live Code</span></button>
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show noprint">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#aufstellen-einer-partiellen-differentialgleichung">
   Aufstellen einer partiellen Differentialgleichung
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#graphische-darstellung">
   Graphische Darstellung
  </a>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Verkehrssimulation mit finiten Volumen</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#aufstellen-einer-partiellen-differentialgleichung">
   Aufstellen einer partiellen Differentialgleichung
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#graphische-darstellung">
   Graphische Darstellung
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            
              <div>
                
  <div class="sphinx-bs container pb-4 docutils">
<div class="row docutils">
<div class="d-flex col-lg-6 col-md-6 col-sm-6 col-xs-12 p-2 docutils">
<div class="card w-100 shadow docutils">
<div class="card-header docutils">
<p class="card-text">Voraussetzungen</p>
</div>
<div class="card-body docutils">
<ul class="simple">
<li><p class="card-text">mathematisches und numerisches GrundverstÃ¤ndnis</p></li>
</ul>
</div>
</div>
</div>
<div class="d-flex col-lg-6 col-md-6 col-sm-6 col-xs-12 p-2 docutils">
<div class="card w-100 shadow docutils">
<div class="card-header docutils">
<p class="card-text">Lerninhalte</p>
</div>
<div class="card-body docutils">
<ul class="simple">
<li><p class="card-text">Nachvollziehen eines Beispiels zur Implementierung des Finite-Volumen-Verfahrens mit der WENO-Methode</p></li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="verkehrssimulation-mit-finiten-volumen">
<span id="traffic-pde"></span><h1>Verkehrssimulation mit finiten Volumen<a class="headerlink" href="#verkehrssimulation-mit-finiten-volumen" title="Permalink to this headline">Â¶</a></h1>
<p>In dem Kapitel <a class="reference internal" href="../00_einleitung/01_motivation.html#traffic-motivation"><span class="std std-ref">Das Stauproblem - Motivation zur Benutzung dieses Buches</span></a> haben wir ein Beispiel zur Verkehrssimulation kennengelernt. Mit partiellen Differentialgleichungen kÃ¶nnen wir auch unser Verkehrsmodell wesentlich realistischer lÃ¶sen und verschiedene Situationen simulieren. In diesem Kapitel ist dafÃ¼r ein Beispiel gegeben. Unten finden Sie die grafische Ausgabe aus Matlab.</p>
<div class="section" id="aufstellen-einer-partiellen-differentialgleichung">
<h2>Aufstellen einer partiellen Differentialgleichung<a class="headerlink" href="#aufstellen-einer-partiellen-differentialgleichung" title="Permalink to this headline">Â¶</a></h2>
<p>Der Situation liegt ein Transportproblem zugrunde:</p>
<div class="math notranslate nohighlight">
\[0=\frac{\partial \rho}{\partial t} + \frac{\partial}{\partial x}(\rho u)\]</div>
<p>FÃ¼r die Geschwindigkeit lÃ¤sst sich eine Funktion abhÃ¤ngig von der lokalen Verkehrsdichte aufstellen:</p>
<div class="math notranslate nohighlight">
\[\begin{split}u(\rho) = \left\{ \begin{matrix} u_\text{max} &amp; \text{, falls } \rho &lt; \rho_\text{krit}\\ c \cdot \ln \left( \frac{\rho}{\rho_\text{max}}\right) &amp; \text{, falls } \rho \ge \rho_\text{krit}\end{matrix} \right. \end{split}\]</div>
<p>Das bedeutet, dass bis zu einer kritischen Verkehrsdichte alle Fahrzeuge mit der maximal mÃ¶glichen Geschwindigkeit fahren kÃ¶nnen. Danach nimmt die durchschnittliche Geschwindigkeit logarithmisch ab, bis alle Fahrzeuge bei der maximalen Dichte direkt hintereinander zum Stillstand kommen. In der unten stehenden Grafik ist als maximale Geschwindigkeit <span class="math notranslate nohighlight">\(130 \frac{\text{km}}{\text{h}}\)</span>, fÃ¼r die kritische Dichte <span class="math notranslate nohighlight">\(\frac{1 \text{ Fahrzeug}}{100 \text{ m}}\)</span> und fÃ¼r die maximale Dichte <span class="math notranslate nohighlight">\(\frac{1 \text{ Fahrzeug}}{6 \text{ m}}\)</span> angenommen.</p>
<div class="admonition-hinweis admonition">
<p class="admonition-title">Hinweis</p>
<p>Diese Funktion lÃ¤sst sich auch mit dem Nagel-Schreckenberg-Modell herleiten, siehe dazu die Ãœbung <a class="reference internal" href="../01_uebungen/02_verkehrssimulation.html#naschr"><span class="std std-ref">Verkehrssimulation mit zellulÃ¤ren Automaten</span></a>.</p>
</div>
<div class="cell tag_hide_input docutils container">
<div class="cell_input docutils container">
<div class="highlight-octave notranslate"><div class="highlight"><pre><span></span><span class="c">% if your Octave kernel does not plot, write `graphics_toolkit(&quot;gnuplot&quot;)`</span>
<span class="n">rho</span> <span class="p">=</span> <span class="nb">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">rho_max</span><span class="p">,</span><span class="mi">100</span><span class="p">);</span>
<span class="n">rho_krit</span> <span class="p">=</span> <span class="mi">1</span><span class="o">/</span><span class="mi">100</span><span class="p">;</span>
<span class="n">u_max</span> <span class="p">=</span> <span class="mi">130</span><span class="p">;</span>
<span class="n">rho_max</span> <span class="p">=</span> <span class="mi">1</span><span class="o">/</span><span class="mi">6</span><span class="p">;</span>
<span class="n">c</span> <span class="p">=</span> <span class="n">u_max</span><span class="o">/</span><span class="nb">log</span><span class="p">(</span><span class="n">rho_krit</span><span class="o">/</span><span class="n">rho_max</span><span class="p">);</span>

<span class="k">for</span> <span class="n">i</span> <span class="p">=</span> <span class="mi">1</span><span class="p">:</span><span class="nb">length</span><span class="p">(</span><span class="n">rho</span><span class="p">)</span>
  <span class="k">if</span> <span class="n">rho</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">rho_krit</span>
      <span class="n">u</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="p">=</span> <span class="n">u_max</span><span class="p">;</span>
  <span class="k">else</span>
      <span class="n">u</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="p">=</span> <span class="n">c</span><span class="o">*</span><span class="nb">log</span><span class="p">(</span><span class="n">rho</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">/</span><span class="n">rho_max</span><span class="p">);</span>
  <span class="k">end</span>
<span class="k">end</span>

<span class="nb">figure</span>
<span class="nb">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span>
<span class="nb">plot</span><span class="p">(</span><span class="n">rho</span><span class="p">,</span><span class="n">u</span><span class="p">)</span>
<span class="n">ylim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="n">u_max</span><span class="o">+</span><span class="mi">5</span><span class="p">])</span>
<span class="nb">xlim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="n">rho_max</span><span class="p">])</span>
<span class="nb">title</span><span class="p">({</span><span class="s">&#39;average velocity over density&#39;</span><span class="p">,</span><span class="s">&#39;as derived from Nagel-Schreckenberg model&#39;</span><span class="p">});</span>
<span class="nb">xlabel</span><span class="p">(</span><span class="s">&#39;density&#39;</span><span class="p">);</span>
<span class="nb">ylabel</span><span class="p">(</span><span class="s">&#39;average velocity [km/h]&#39;</span><span class="p">);</span>
<span class="nb">drawnow</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/03_trafficPDE_2_0.png" src="../_images/03_trafficPDE_2_0.png" />
</div>
</div>
<div style=\"text-align: right\"> Abbildung 1: Durchschnittliche Geschwindigkeit in Kilometer pro Stunde Ã¼ber Fahrzeugdichte in Autos pro Meter. Der Zusammenhang wurde aus dem Nagel-Schreckenberg Modell abgeleitet.</div> <br>
</div>
<div class="section" id="graphische-darstellung">
<h2>Graphische Darstellung<a class="headerlink" href="#graphische-darstellung" title="Permalink to this headline">Â¶</a></h2>
<p>Leider funktioniert die dynamische graphische Darstellung in Octave nicht. Stattdessen kÃ¶nnen Sie den untenstehenden Code herunterladen und in Matlab ausfÃ¼hren.</p>
<a class="reference internal image-reference" href="../_images/highway_jam.gif"><img alt="highway_jam" class="align-center" src="../_images/highway_jam.gif" style="width: 800px;" /></a>
<div style=\"text-align: right\"> Abbildung 2: AuflÃ¶sung eines Staus auf einem StraÃŸenabschnitt.</div> <br>
<a class="reference internal image-reference" href="../_images/highway_light_green.gif"><img alt="highway_light_green" class="align-center" src="../_images/highway_light_green.gif" style="width: 800px;" /></a>
<div style=\"text-align: right\"> Abbildung 3: StraÃŸenabschnitt beim Losfahren von einer grÃ¼nen Ampel.</div> <br>
<a class="reference internal image-reference" href="../_images/highway_light_red.gif"><img alt="highway_light_red" class="align-center" src="../_images/highway_light_red.gif" style="width: 800px;" /></a>
<div style=\"text-align: right\"> Abbildung 4: StraÃŸenabschnitt beim Auffahren an eine rote Ampel.</div> <br><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-octave notranslate"><div class="highlight"><pre><span></span><span class="k">function</span><span class="w"> </span><span class="nf">autobahn</span>
<span class="c">%-- mit FV WENO-Verfahren 3. Ordnung</span>
<span class="n">clear</span> <span class="nb">all</span>
<span class="c">%--</span>
<span class="k">global</span> <span class="n">u_max</span> <span class="n">rho_max</span> <span class="n">rho_krit</span> <span class="n">c</span>
<span class="n">u_max</span> <span class="p">=</span> <span class="mi">50</span><span class="p">;</span> <span class="c">% 180 km/h</span>
<span class="n">rho_max</span> <span class="p">=</span> <span class="mi">1</span><span class="o">/</span><span class="mi">6</span><span class="p">;</span> <span class="c">% 1 Auto auf 6 m</span>
<span class="n">rho_krit</span> <span class="p">=</span> <span class="mi">1</span><span class="o">/</span><span class="mi">100</span><span class="p">;</span> 
<span class="n">c</span> <span class="p">=</span> <span class="n">u_max</span><span class="o">/</span><span class="nb">log</span><span class="p">(</span><span class="n">rho_krit</span><span class="o">/</span><span class="n">rho_max</span><span class="p">);</span>
<span class="k">global</span> <span class="n">x</span> <span class="n">dx</span> <span class="n">n</span>
<span class="n">n</span> <span class="p">=</span> <span class="mi">100</span><span class="p">;</span> <span class="n">dx</span> <span class="p">=</span> <span class="mi">100000</span><span class="o">/</span><span class="n">n</span><span class="p">;</span>
<span class="n">x</span> <span class="p">=</span> <span class="nb">linspace</span><span class="p">(</span><span class="n">dx</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="mi">100000</span><span class="o">-</span><span class="n">dx</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">n</span><span class="p">);</span> <span class="c">%-- Zellenmittelpunkte</span>
<span class="c">%-- SteuauflÃ¶sung</span>
<span class="n">y0</span> <span class="p">=</span> <span class="mf">0.1</span><span class="o">*</span><span class="nb">exp</span><span class="p">(</span><span class="o">-</span><span class="mf">1.0e-6</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="mi">10000</span><span class="p">)</span><span class="o">.^</span><span class="mi">2</span><span class="p">);</span> <span class="n">tspan</span> <span class="p">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">6000</span><span class="p">];</span>
<span class="c">%-- Ampel gruen</span>
<span class="c">%y0 = 0*x; ff = find(x &lt; 50000); y0(ff)=1/6; tspan = [0, 900];</span>
<span class="c">%-- Ampel rot</span>
<span class="c">%y0 = 0*x+1/100; ff = find(x &gt; 70000); y0(ff)=1/6; tspan = [0, 1400];</span>
<span class="c">%-- Integrator</span>
<span class="n">tol</span> <span class="p">=</span> <span class="mf">1.0e-4</span><span class="p">;</span>
<span class="n">options</span><span class="p">=</span><span class="n">odeset</span><span class="p">(</span><span class="s">&#39;Stats&#39;</span><span class="p">,</span><span class="s">&#39;on&#39;</span><span class="p">,</span><span class="s">&#39;RelTol&#39;</span><span class="p">,</span><span class="n">tol</span><span class="p">,</span><span class="s">&#39;AbsTol&#39;</span><span class="p">,</span><span class="n">tol</span><span class="p">,</span><span class="s">&#39;OutputFcn&#39;</span><span class="p">,@</span><span class="n">plot_sol</span><span class="p">);</span>
<span class="nb">tic</span>
<span class="p">[</span><span class="n">t</span><span class="p">,</span><span class="n">y</span><span class="p">]</span> <span class="p">=</span> <span class="n">ode45</span><span class="p">(@</span><span class="n">dgl</span><span class="p">,</span><span class="n">tspan</span><span class="p">,</span><span class="n">y0</span><span class="p">,</span><span class="n">options</span><span class="p">);</span>
<span class="nb">toc</span>
<span class="n">nt</span> <span class="p">=</span> <span class="nb">length</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>

<span class="k">function</span><span class="w"> </span>dy<span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nf">dgl</span><span class="p">(</span>t,y<span class="p">)</span>
<span class="k">global</span> <span class="n">x</span> <span class="n">dx</span> <span class="n">n</span>
<span class="c">%--</span>
<span class="n">nord</span> <span class="p">=</span> <span class="mi">3</span><span class="p">;</span>
<span class="n">rho</span> <span class="p">=</span> <span class="n">y</span><span class="o">&#39;</span><span class="p">;</span> <span class="c">% Zellenmittelwerte 1,..,n als Zeilenvektor</span>
<span class="p">[</span><span class="n">rhoL</span><span class="p">,</span><span class="n">rhoR</span><span class="p">]=</span><span class="n">mc_extrapol</span><span class="p">(</span><span class="n">rho</span><span class="p">);</span>  <span class="c">% rho auf x_1/2 bzw. x_n+1/2 extrapolieren</span>
<span class="n">rho</span> <span class="p">=</span> <span class="p">[</span><span class="n">rhoL</span><span class="p">,</span><span class="n">rho</span><span class="p">,</span><span class="n">rhoR</span><span class="p">];</span>
<span class="p">[</span><span class="n">rho_m</span><span class="p">,</span><span class="n">rho_p</span><span class="p">]=</span><span class="n">mc_recover_pcweno</span><span class="p">(</span><span class="n">rho</span><span class="p">,</span><span class="n">nord</span><span class="p">);</span>  <span class="c">% Werte auf Zellgrenzen interpolieren</span>
<span class="n">u_m</span> <span class="p">=</span> <span class="n">uvonrho</span><span class="p">(</span><span class="n">rho_m</span><span class="p">);</span> <span class="n">u_p</span> <span class="p">=</span> <span class="n">uvonrho</span><span class="p">(</span><span class="n">rho_p</span><span class="p">);</span> 
<span class="n">q_m</span> <span class="p">=</span> <span class="n">u_m</span><span class="o">.*</span><span class="n">rho_m</span><span class="p">;</span> <span class="n">q_p</span> <span class="p">=</span> <span class="n">u_p</span><span class="o">.*</span><span class="n">rho_p</span><span class="p">;</span> 
<span class="n">lam_m</span> <span class="p">=</span> <span class="n">eigen</span><span class="p">(</span><span class="n">rho_m</span><span class="p">,</span><span class="n">u_m</span><span class="p">);</span> <span class="n">lam_p</span> <span class="p">=</span> <span class="n">eigen</span><span class="p">(</span><span class="n">rho_p</span><span class="p">,</span><span class="n">u_p</span><span class="p">);</span>
<span class="n">f_r</span> <span class="p">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="k">for</span> <span class="n">i</span><span class="p">=</span><span class="mi">1</span><span class="p">:</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span>  <span class="c">% durchlaufe alle Zellgrenzen, der Fluss auf Grenze i heiÃŸt f_r</span>
    <span class="n">f_l</span> <span class="p">=</span> <span class="n">f_r</span><span class="p">;</span>
    <span class="n">lambda</span> <span class="p">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">lam_m</span><span class="p">(</span><span class="n">i</span><span class="p">),</span><span class="n">lam_p</span><span class="p">(</span><span class="n">i</span><span class="p">));</span> 
    <span class="n">f_r</span> <span class="p">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="p">(</span> <span class="n">q_m</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="n">q_p</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">-</span> <span class="n">lambda</span><span class="o">*</span><span class="p">(</span> <span class="n">rho_p</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">-</span><span class="n">rho_m</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="p">)</span> <span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">i</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span> <span class="n">f_r</span><span class="p">=</span><span class="mi">0</span><span class="p">;</span> <span class="k">end</span> <span class="c">%-- linke RB</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">i</span><span class="o">==</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span> <span class="o">&amp;&amp;</span> <span class="n">f_r</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span>
        <span class="n">f_r</span> <span class="p">=</span> <span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">;</span>
    <span class="k">end</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">i</span><span class="o">&gt;</span><span class="mi">1</span><span class="p">)</span>
      <span class="n">dy</span><span class="p">(</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="p">=</span> <span class="o">-</span><span class="p">(</span><span class="n">f_r</span><span class="o">-</span><span class="n">f_l</span><span class="p">)</span><span class="o">/</span><span class="n">dx</span><span class="p">;</span>
    <span class="k">end</span>
<span class="k">end</span>

<span class="k">function</span><span class="w"> </span>status<span class="p">=</span><span class="nf">plot_sol</span><span class="p">(</span>t,y,flag<span class="p">)</span>
<span class="k">global</span> <span class="n">x</span> <span class="n">dx</span> <span class="n">n</span>
<span class="k">global</span> <span class="n">line_rho</span> <span class="n">line_u</span>
<span class="c">%--</span>
<span class="k">if</span> <span class="nb">strcmp</span><span class="p">(</span><span class="nb">flag</span><span class="p">,</span><span class="s">&#39;done&#39;</span><span class="p">)</span> 
    <span class="n">status</span><span class="p">=</span><span class="mi">0</span><span class="p">;</span> <span class="nb">hold</span> <span class="n">off</span><span class="p">;</span> <span class="k">return</span><span class="p">;</span> 
<span class="k">end</span>
<span class="n">rho</span> <span class="p">=</span> <span class="n">y</span><span class="p">(:,</span><span class="k">end</span><span class="p">);</span> <span class="n">u</span> <span class="p">=</span> <span class="n">uvonrho</span><span class="p">(</span><span class="n">rho</span><span class="p">);</span>
<span class="k">if</span> <span class="nb">strcmp</span><span class="p">(</span><span class="nb">flag</span><span class="p">,</span><span class="s">&#39;init&#39;</span><span class="p">)</span>
<span class="c">%   subplot(1,2,1)</span>
   <span class="nb">axis</span><span class="p">([</span><span class="n">x</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">x</span><span class="p">(</span><span class="n">n</span><span class="p">),</span> <span class="o">-</span><span class="mf">0.1</span><span class="p">,</span> <span class="mi">170</span><span class="p">]);</span>
   <span class="n">line_rho</span> <span class="p">=</span> <span class="nb">line</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">rho</span><span class="o">*</span><span class="mi">1000</span><span class="p">,</span>   <span class="s">&#39;Color&#39;</span><span class="p">,</span><span class="s">&#39;red&#39;</span><span class="p">);</span>
   <span class="n">line_u</span>   <span class="p">=</span> <span class="nb">line</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">u</span>  <span class="p">,</span>   <span class="s">&#39;Color&#39;</span><span class="p">,</span><span class="s">&#39;blue&#39;</span><span class="p">);</span>
<span class="k">else</span>
    <span class="n">tt</span> <span class="p">=</span> <span class="n">t</span><span class="p">(</span><span class="k">end</span><span class="p">);</span>
   <span class="k">set</span><span class="p">(</span><span class="n">line_rho</span><span class="p">,</span><span class="s">&#39;ydata&#39;</span><span class="p">,</span><span class="n">rho</span><span class="o">*</span><span class="mi">1000</span><span class="p">);</span>
   <span class="k">set</span><span class="p">(</span><span class="n">line_u</span>  <span class="p">,</span><span class="s">&#39;ydata&#39;</span><span class="p">,</span><span class="n">u</span><span class="p">);</span>
<span class="k">end</span>
<span class="n">status</span><span class="p">=</span><span class="mi">0</span><span class="p">;</span>
<span class="nb">legend</span><span class="p">(</span><span class="s">&#39;1000*\rho&#39;</span><span class="p">,</span><span class="s">&#39;u&#39;</span><span class="p">);</span>
<span class="nb">pause</span><span class="p">(</span><span class="mf">0.1</span><span class="p">);</span>
<span class="nb">drawnow</span>

<span class="k">function</span><span class="w"> </span>u<span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nf">uvonrho</span><span class="p">(</span>rho<span class="p">)</span>
<span class="k">global</span> <span class="n">u_max</span> <span class="n">rho_max</span> <span class="n">rho_krit</span> <span class="n">c</span>
<span class="c">%--</span>
<span class="n">u</span> <span class="p">=</span> <span class="mi">0</span><span class="o">*</span><span class="n">rho</span><span class="o">+</span><span class="n">u_max</span><span class="p">;</span>
<span class="n">ff</span> <span class="p">=</span> <span class="nb">find</span><span class="p">(</span><span class="n">rho</span> <span class="o">&gt;</span> <span class="n">rho_krit</span><span class="p">);</span> <span class="n">u</span><span class="p">(</span><span class="n">ff</span><span class="p">)</span> <span class="p">=</span> <span class="n">c</span><span class="o">*</span><span class="nb">log</span><span class="p">(</span><span class="n">rho</span><span class="p">(</span><span class="n">ff</span><span class="p">)</span><span class="o">/</span><span class="n">rho_max</span><span class="p">);</span>
<span class="n">ff</span> <span class="p">=</span> <span class="nb">find</span><span class="p">(</span><span class="n">rho</span> <span class="o">&gt;</span> <span class="n">rho_max</span><span class="p">);</span>  <span class="n">u</span><span class="p">(</span><span class="n">ff</span><span class="p">)=</span><span class="mi">0</span><span class="p">;</span>

<span class="k">function</span><span class="w"> </span>lam<span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nf">eigen</span><span class="p">(</span>rho,u<span class="p">)</span>
<span class="k">global</span> <span class="n">u_max</span> <span class="n">rho_max</span> <span class="n">rho_krit</span> <span class="n">c</span>
<span class="c">%--</span>
<span class="n">lam</span> <span class="p">=</span> <span class="n">u</span><span class="p">;</span>
<span class="n">ff</span> <span class="p">=</span> <span class="nb">find</span><span class="p">((</span><span class="n">rho</span> <span class="o">&gt;</span> <span class="n">rho_krit</span><span class="p">)</span><span class="o">&amp;</span><span class="p">(</span><span class="n">rho</span> <span class="o">&lt;</span> <span class="n">rho_max</span><span class="p">));</span> <span class="n">lam</span><span class="p">(</span><span class="n">ff</span><span class="p">)</span> <span class="p">=</span> <span class="n">lam</span><span class="p">(</span><span class="n">ff</span><span class="p">)</span><span class="o">+</span><span class="n">c</span><span class="p">;</span>
<span class="n">lam</span><span class="p">=</span><span class="nb">abs</span><span class="p">(</span><span class="n">lam</span><span class="p">);</span>

<span class="k">function</span><span class="w"> </span>[yL,yR]<span class="p">=</span><span class="nf">mc_extrapol</span><span class="p">(</span>y<span class="p">)</span>
<span class="c">%-- Extrapoliere Zellenmittel y der LÃ¤nge n auf Zellgrenze i=1/2 (=yL) und i=n+1/2 (=yR),</span>
<span class="n">n</span> <span class="p">=</span> <span class="nb">length</span><span class="p">(</span><span class="n">y</span><span class="p">);</span>
<span class="n">yR</span> <span class="p">=</span> <span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">y</span><span class="p">(</span><span class="n">n</span><span class="p">)</span><span class="o">-</span><span class="n">y</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span><span class="o">/</span><span class="mi">2</span><span class="p">;</span> <span class="n">yL</span><span class="p">=(</span><span class="mi">3</span><span class="o">*</span><span class="n">y</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">-</span><span class="n">y</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">/</span><span class="mi">2</span><span class="p">;</span> <span class="c">%-- lineare Extrap.</span>

<span class="k">function</span><span class="w"> </span>[yL,yR]<span class="p">=</span><span class="nf">mc_recover_pcweno</span><span class="p">(</span>y,nord<span class="p">)</span>
<span class="c">%-- Interpoliere Zellenmittelwerte y_i auf Zellgrenzen y_i+1/2</span>
<span class="c">%-- y enthÃ¤lt y_1/2, y_1,...,y_nx,y_nx+1/2</span>
<span class="c">%-- yL enthaelt  y_1/2^-,...,y_nx+1/2^-</span>
<span class="c">%-- yR enthaelt  y_1/2^+,...,y_nx+1/2^+</span>
<span class="n">n</span> <span class="p">=</span> <span class="nb">length</span><span class="p">(</span><span class="n">y</span><span class="p">);</span>
<span class="n">i</span> <span class="p">=</span> <span class="mi">1</span><span class="p">:</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">;</span> <span class="n">ip1</span><span class="p">=</span><span class="mi">2</span><span class="p">:</span><span class="n">n</span><span class="p">;</span> <span class="n">im1</span><span class="p">=[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="n">n</span><span class="o">-</span><span class="mi">2</span><span class="p">];</span> <span class="n">ip2</span><span class="p">=[</span><span class="mi">3</span><span class="p">:</span><span class="n">n</span><span class="p">,</span><span class="n">n</span><span class="p">];</span> 
<span class="c">%-- nx = 1 </span>
<span class="k">if</span> <span class="n">n</span><span class="o">==</span><span class="mi">3</span>
    <span class="n">yL</span> <span class="p">=</span> <span class="p">[</span><span class="n">y</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">y</span><span class="p">(</span><span class="mi">3</span><span class="p">)];</span> <span class="n">yR</span> <span class="p">=</span> <span class="n">yL</span><span class="p">;</span>
    <span class="k">return</span>
<span class="k">end</span>
<span class="c">%-- Extrapolation vom Rand in die Mitte auf -dx/2 bzw. (n+1)*dx</span>
  <span class="n">yL_save</span> <span class="p">=</span> <span class="n">y</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span> <span class="n">yR_save</span> <span class="p">=</span> <span class="n">y</span><span class="p">(</span><span class="n">n</span><span class="p">);</span>
  <span class="n">y</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">y</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="n">y</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span> <span class="n">y</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="p">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">y</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="o">-</span> <span class="n">y</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">);</span>
<span class="c">%---- nord = 1</span>
<span class="n">yR</span> <span class="p">=</span> <span class="n">y</span><span class="p">(</span><span class="n">ip1</span><span class="p">);</span> <span class="n">yL</span> <span class="p">=</span> <span class="n">y</span><span class="p">(</span><span class="n">i</span><span class="p">);</span>   
<span class="k">if</span> <span class="n">nord</span><span class="o">==</span><span class="mi">2</span>
  <span class="n">sL</span> <span class="p">=</span> <span class="n">y</span><span class="p">(</span><span class="n">ip1</span><span class="p">)</span><span class="o">-</span><span class="n">y</span><span class="p">(</span><span class="n">i</span><span class="p">);</span> <span class="n">sR</span> <span class="p">=</span> <span class="n">y</span><span class="p">(</span><span class="n">ip2</span><span class="p">)</span><span class="o">-</span><span class="n">y</span><span class="p">(</span><span class="n">ip1</span><span class="p">);</span>  
  <span class="n">r</span> <span class="p">=</span> <span class="n">sL</span><span class="o">./</span><span class="n">sR</span><span class="p">;</span>
  <span class="n">yR</span> <span class="p">=</span> <span class="n">y</span><span class="p">(</span><span class="n">ip1</span><span class="p">)</span> <span class="o">-</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">limiter</span><span class="p">(</span><span class="n">r</span><span class="p">)</span><span class="o">.*</span><span class="n">sR</span><span class="p">;</span>
<span class="c">%--</span>
  <span class="n">sR</span> <span class="p">=</span> <span class="n">sL</span><span class="p">;</span> <span class="n">sL</span> <span class="p">=</span> <span class="n">y</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">-</span><span class="n">y</span><span class="p">(</span><span class="n">im1</span><span class="p">);</span> 
  <span class="n">r</span> <span class="p">=</span> <span class="n">sL</span><span class="o">./</span><span class="n">sR</span><span class="p">;</span>
  <span class="n">yL</span> <span class="p">=</span> <span class="n">y</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">limiter</span><span class="p">(</span><span class="n">r</span><span class="p">)</span><span class="o">.*</span><span class="n">sR</span><span class="p">;</span>
<span class="c">%-- Randkorrektur</span>
  <span class="n">yL</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">=</span> <span class="n">yL_save</span><span class="p">;</span> <span class="n">yR</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="p">=</span> <span class="n">yR_save</span><span class="p">;</span>
  <span class="n">yR</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">=</span> <span class="n">yL_save</span><span class="p">;</span> <span class="n">yL</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="p">=</span> <span class="n">yR_save</span><span class="p">;</span> 
<span class="k">elseif</span> <span class="n">nord</span><span class="o">==</span><span class="mi">3</span>
  <span class="n">ep</span> <span class="p">=</span> <span class="mf">1.0e-6</span><span class="p">;</span> <span class="n">p</span> <span class="p">=</span> <span class="mf">0.6</span><span class="p">;</span> 
  <span class="n">uL</span> <span class="p">=</span> <span class="n">y</span><span class="p">(</span><span class="n">ip1</span><span class="p">)</span><span class="o">-</span><span class="n">y</span><span class="p">(</span><span class="n">i</span><span class="p">);</span> <span class="n">uC</span> <span class="p">=</span> <span class="n">y</span><span class="p">(</span><span class="n">ip2</span><span class="p">)</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">y</span><span class="p">(</span><span class="n">ip1</span><span class="p">)</span><span class="o">+</span><span class="n">y</span><span class="p">(</span><span class="n">i</span><span class="p">);</span> <span class="n">uR</span> <span class="p">=</span> <span class="n">y</span><span class="p">(</span><span class="n">ip2</span><span class="p">)</span><span class="o">-</span><span class="n">y</span><span class="p">(</span><span class="n">ip1</span><span class="p">);</span> <span class="n">uCC</span> <span class="p">=</span> <span class="n">y</span><span class="p">(</span><span class="n">ip2</span><span class="p">)</span><span class="o">-</span><span class="n">y</span><span class="p">(</span><span class="n">i</span><span class="p">);</span>
  <span class="n">ISL</span> <span class="p">=</span> <span class="n">uL</span><span class="o">.^</span><span class="mi">2</span><span class="p">;</span> <span class="n">ISC</span> <span class="p">=</span> <span class="mi">13</span><span class="o">/</span><span class="mi">3</span><span class="o">*</span><span class="n">uC</span><span class="o">.^</span><span class="mi">2</span> <span class="o">+</span><span class="mf">0.25</span><span class="o">*</span><span class="n">uCC</span><span class="o">.^</span><span class="mi">2</span><span class="p">;</span> <span class="n">ISR</span> <span class="p">=</span> <span class="n">uR</span><span class="o">.^</span><span class="mi">2</span><span class="p">;</span>
  <span class="n">aL</span> <span class="p">=</span> <span class="mf">0.25</span><span class="o">*</span><span class="p">(</span><span class="mf">1.</span><span class="o">/</span><span class="p">(</span><span class="n">ep</span><span class="o">+</span><span class="n">ISL</span><span class="p">))</span><span class="o">.^</span><span class="n">p</span><span class="p">;</span> <span class="n">aC</span> <span class="p">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="mf">1.</span><span class="o">/</span><span class="p">(</span><span class="n">ep</span><span class="o">+</span><span class="n">ISC</span><span class="p">))</span><span class="o">.^</span><span class="n">p</span><span class="p">;</span> <span class="n">aR</span> <span class="p">=</span> <span class="mf">0.25</span><span class="o">*</span><span class="p">(</span><span class="mf">1.</span><span class="o">/</span><span class="p">(</span><span class="n">ep</span><span class="o">+</span><span class="n">ISR</span><span class="p">))</span><span class="o">.^</span><span class="n">p</span><span class="p">;</span>
  <span class="n">suma</span> <span class="p">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">aL</span><span class="o">+</span><span class="n">aC</span><span class="o">+</span><span class="n">aR</span><span class="p">,</span><span class="nb">eps</span><span class="p">);</span>  <span class="n">wL</span> <span class="p">=</span> <span class="n">aL</span><span class="o">./</span><span class="n">suma</span><span class="p">;</span> <span class="n">wC</span> <span class="p">=</span> <span class="n">aC</span><span class="o">./</span><span class="n">suma</span><span class="p">;</span> <span class="n">wR</span> <span class="p">=</span> <span class="n">aR</span><span class="o">./</span><span class="n">suma</span><span class="p">;</span>
  <span class="n">weights</span> <span class="p">=</span> <span class="p">[</span><span class="mf">0.5</span><span class="o">*</span><span class="n">wL</span> <span class="o">+</span> <span class="mi">5</span><span class="o">/</span><span class="mi">12</span><span class="o">*</span><span class="n">wC</span><span class="p">;</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">wL</span><span class="o">+</span><span class="mi">2</span><span class="o">/</span><span class="mi">3</span><span class="o">*</span><span class="n">wC</span><span class="o">+</span><span class="mf">1.5</span><span class="o">*</span><span class="n">wR</span> <span class="p">;</span>  <span class="o">-</span><span class="n">wC</span><span class="o">/</span><span class="mi">12</span><span class="o">-</span><span class="mf">0.5</span><span class="o">*</span><span class="n">wR</span><span class="p">];</span>
  <span class="n">yR</span> <span class="p">=</span> <span class="n">y</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">.*</span><span class="n">weights</span><span class="p">(</span><span class="mi">1</span><span class="p">,:)</span> <span class="o">+</span> <span class="n">y</span><span class="p">(</span><span class="n">ip1</span><span class="p">)</span><span class="o">.*</span><span class="n">weights</span><span class="p">(</span><span class="mi">2</span><span class="p">,:)</span> <span class="o">+</span><span class="n">y</span><span class="p">(</span><span class="n">ip2</span><span class="p">)</span><span class="o">.*</span><span class="n">weights</span><span class="p">(</span><span class="mi">3</span><span class="p">,:);</span>
<span class="c">%--</span>
  <span class="n">uR</span> <span class="p">=</span> <span class="n">uL</span><span class="p">;</span> <span class="n">uL</span> <span class="p">=</span> <span class="n">y</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">-</span><span class="n">y</span><span class="p">(</span><span class="n">im1</span><span class="p">);</span> <span class="n">uC</span> <span class="p">=</span> <span class="n">y</span><span class="p">(</span><span class="n">ip1</span><span class="p">)</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">y</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="n">y</span><span class="p">(</span><span class="n">im1</span><span class="p">);</span> <span class="n">uCC</span> <span class="p">=</span> <span class="n">y</span><span class="p">(</span><span class="n">ip1</span><span class="p">)</span><span class="o">-</span><span class="n">y</span><span class="p">(</span><span class="n">im1</span><span class="p">);</span>
  <span class="n">ISL</span> <span class="p">=</span> <span class="n">uL</span><span class="o">.^</span><span class="mi">2</span><span class="p">;</span> <span class="n">ISC</span> <span class="p">=</span> <span class="mi">13</span><span class="o">/</span><span class="mi">3</span><span class="o">*</span><span class="n">uC</span><span class="o">.^</span><span class="mi">2</span> <span class="o">+</span><span class="mf">0.25</span><span class="o">*</span><span class="n">uCC</span><span class="o">.^</span><span class="mi">2</span><span class="p">;</span> <span class="n">ISR</span> <span class="p">=</span> <span class="n">uR</span><span class="o">.^</span><span class="mi">2</span><span class="p">;</span>
  <span class="n">aL</span> <span class="p">=</span> <span class="mf">0.25</span><span class="o">*</span><span class="p">(</span><span class="mf">1.</span><span class="o">/</span><span class="p">(</span><span class="n">ep</span><span class="o">+</span><span class="n">ISL</span><span class="p">))</span><span class="o">.^</span><span class="n">p</span><span class="p">;</span> <span class="n">aC</span> <span class="p">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="mf">1.</span><span class="o">/</span><span class="p">(</span><span class="n">ep</span><span class="o">+</span><span class="n">ISC</span><span class="p">))</span><span class="o">.^</span><span class="n">p</span><span class="p">;</span> <span class="n">aR</span> <span class="p">=</span> <span class="mf">0.25</span><span class="o">*</span><span class="p">(</span><span class="mf">1.</span><span class="o">/</span><span class="p">(</span><span class="n">ep</span><span class="o">+</span><span class="n">ISR</span><span class="p">))</span><span class="o">.^</span><span class="n">p</span><span class="p">;</span>
  <span class="n">suma</span> <span class="p">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">aL</span><span class="o">+</span><span class="n">aC</span><span class="o">+</span><span class="n">aR</span><span class="p">,</span><span class="nb">eps</span><span class="p">);</span>  <span class="n">wL</span> <span class="p">=</span> <span class="n">aL</span><span class="o">./</span><span class="n">suma</span><span class="p">;</span> <span class="n">wC</span> <span class="p">=</span> <span class="n">aC</span><span class="o">./</span><span class="n">suma</span><span class="p">;</span> <span class="n">wR</span> <span class="p">=</span> <span class="n">aR</span><span class="o">./</span><span class="n">suma</span><span class="p">;</span>
  <span class="n">weights</span> <span class="p">=</span> <span class="p">[</span><span class="n">weights</span><span class="p">;</span> <span class="o">-</span><span class="mf">0.5</span><span class="o">*</span><span class="n">wL</span><span class="o">-</span><span class="n">wC</span><span class="o">/</span><span class="mi">12</span><span class="p">;</span> <span class="mf">1.5</span><span class="o">*</span><span class="n">wL</span><span class="o">+</span><span class="mi">2</span><span class="o">/</span><span class="mi">3</span><span class="o">*</span><span class="n">wC</span><span class="o">+</span><span class="mf">0.5</span><span class="o">*</span><span class="n">wR</span><span class="p">;</span> <span class="mi">5</span><span class="o">/</span><span class="mi">12</span><span class="o">*</span><span class="n">wC</span><span class="o">+</span><span class="mf">0.5</span><span class="o">*</span><span class="n">wR</span><span class="p">];</span>
  <span class="n">yL</span> <span class="p">=</span> <span class="n">y</span><span class="p">(</span><span class="n">im1</span><span class="p">)</span><span class="o">.*</span><span class="n">weights</span><span class="p">(</span><span class="mi">4</span><span class="p">,:)</span> <span class="o">+</span> <span class="n">y</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">.*</span><span class="n">weights</span><span class="p">(</span><span class="mi">5</span><span class="p">,:)</span> <span class="o">+</span> <span class="n">y</span><span class="p">(</span><span class="n">ip1</span><span class="p">)</span><span class="o">.*</span><span class="n">weights</span><span class="p">(</span><span class="mi">6</span><span class="p">,:);</span>
<span class="c">%-- Randkorrektur</span>
  <span class="n">yL</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">=</span> <span class="n">yL_save</span><span class="p">;</span> <span class="n">yR</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="p">=</span> <span class="n">yR_save</span><span class="p">;</span>
  <span class="n">yR</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">=</span> <span class="n">yL_save</span><span class="p">;</span> <span class="n">yL</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="p">=</span> <span class="n">yR_save</span><span class="p">;</span> 
<span class="k">end</span>

<span class="k">function</span><span class="w"> </span>s<span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nf">limiter</span><span class="p">(</span>r<span class="p">)</span>
<span class="w">  </span><span class="n">r</span> <span class="p">=</span> <span class="nb">min</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">r</span><span class="p">));</span>
  <span class="n">s</span> <span class="p">=</span> <span class="p">(</span><span class="n">r</span><span class="o">.^</span><span class="mi">2</span><span class="o">+</span><span class="n">r</span><span class="p">)</span><span class="o">./</span><span class="p">(</span><span class="n">r</span><span class="o">.^</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span><span class="p">);</span>  <span class="c">% van Albada</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "hbrs-cse/Modellbildung-und-Simulation",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "octave"
        },
        kernelOptions: {
            kernelName: "octave",
            path: "./11_pde"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'octave'</script>

              </div>
              
            
                <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="02_konvektion_und_diffusion.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Konvektion und Diffusion</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="../12_matlab/00_MATLAB_introduction.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Matlab EinfÃ¼hrung</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            
        </div>
    </div>
    <footer class="footer">
  <p>
    
      By Dirk Reith, Jan Kleinert, and Gerd Steinebach<br/>
    
        &copy; Copyright 2020 - 2022.<br/>
  </p>
</footer>
</main>


      </div>
    </div>
  
  <script src="../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>